-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


CREATE EXTENSION IF NOT EXISTS pgcrypto;

ALTER DATABASE ProjetoDelphiJLA SET log_statement = 'ddl';

CREATE TABLE IF NOT EXISTS public."Usuarios"
(
codigo_usuario SERIAL PRIMARY KEY,
nome_usuario VARCHAR(255) UNIQUE NOT NULL,
hash_senha_usuario VARCHAR(255) NOT NULL,

);


CREATE TABLE IF NOT EXISTS public."Clientes"
(
codigo_cliente SERIAL PRIMARY KEY,
hash_senha_cli VARCHAR(255) NOT NULL,
nome_cliente VARCHAR(100) NOT NULL,
telefone_cliente VARCHAR(9) NOT NULL,
email_cliente VARCHAR(250) UNIQUE,
cep_cliente VARCHAR(8),
veiculo VARCHAR(7) NOT NULL,
endereco_cliente VARCHAR(60),
num_endereco VARCHAR(7),
bairro VARCHAR(30),
cidade VARCHAR(30),
uf VARCHAR(2),
funcao VARCHAR,
rg_usuario(9) UNIQUE,
cpf_usuario VARCHAR(11) UNIQUE,
cliente_data_criacao TIMESTAMP
)
;


CREATE TABLE IF NOT EXISTS public."Funcionarios"
(
codigo_funcionario SERIAL PRIMARY KEY,
hash_senha_func VARCHAR(255) NOT NULL,
nome funcion√°rio VARCHAR(100) UNIQUE NOT NULL,
telefone_funcionario VARCHAR(9) NOT NULL,
email_funcionario VARCHAR(255) UNIQUE NOT NULL,
funcao VARCHAR,
rg_funcionario(9) UNIQUE,
cpf_funcionario VARCHAR(11) UNIQUE,
cep_funcionario VARCHAR(8),
endereco_funcionario VARCHAR(60),
num_endereco VARCHAR(7),
bairro VARCHAR(30),
cidade VARCHAR(30),
uf VARCHAR(2),
funcionario_data_criacao TIMESTAMP
)
;


CREATE TABLE IF NOT EXISTS public.tenant_oficina
(
)
;

CREATE TABLE IF NOT EXISTS public.veiculos
(
placa_veiculo VARCHAR(7) PRIMARY KEY,
chassi VARCHAR(17) UNIQUE,
modelo VARCHAR(20),
marca VARCHAR(20),
cor VARCHAR(20),
ano SMALLINT,
nome_cliente FOREIGN KEY,
codigo_cliente FOREIGN KEY,

ADD CONSTRAINT
FOREIGN KEY (nome_cliente)
REFERENCES clientes(nome_cliente),

ADD CONSTRAINT
FOREIGN KEY (codigo_cliente)
REFERENCES clientes(codigo_cliente)
)
;

CREATE TABLE IF NOT EXISTS public.pedidos
(
codigo_pedido INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
nome_cliente VARCHAR(100),
codigo_cliente FOREIGN KEY NOT NULL,
data_pedido CURRENT_DATE NOT NULL,
contato VARCHAR(15) NOT NULL,
endereco_cliente VARCHAR(60),
cep_cliente VARCHAR(8),
placa_veiculo VARCHAR(7),
marca VARCHAR(20),
modelo VARCHAR(20),
cor VARCHAR(20),
descricao_pedido TEXT

ADD CONSTRAINT
FOREIGN KEY (codigo_cliente)
REFERENCES clientes(codigo_cliente)
)
;

CREATE TABLE IF NOT EXISTS public.orcamentos
(
id_orcamento VARCHAR PRIMARY KEY,
id_pedido FOREIGN KEY,
servico_est TEXT NOT NULL,
materiais_est TEXT,
prazo_est INT NOT NULL,
custo_est DOUBLE NOT NULL,
)
;

CREATE TABLE IF NOT EXISTS public.ordens_servico
(
id_ordemservico VARCHAR PRIMARY KEY,
servicos TEXT,
materiais TEXT,
prazo INT,
data_os DATE,
data_entrega DATE,
custo DOUBLE,
veiculo TEXT,
placa_veiculo VARCHAR(7),
nome_cliente VARCHAR(100) NOT NULL,
codigo_cliente FOREIGN KEY,

ADD CONSTRAINT
FOREIGN KEY (placa_veiculo)
REFERENCES veiculos(placa_veiculo),

ADD CONSTRAINT
FOREIGN KEY (nome_cliente)
REFERENCES clientes(nome_cliente),

ADD CONSTRAINT
FOREIGN KEY (codigo_cliente)
REFERENCES clientes(codigo_cliente)
)
;
END;